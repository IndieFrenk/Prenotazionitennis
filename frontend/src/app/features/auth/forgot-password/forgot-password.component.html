<!-- Page header -->
<app-header />

<main class="forgot-password-page">
  <div class="forgot-container">
    <p-card styleClass="forgot-card">
      <!-- Card header -->
      <ng-template pTemplate="header">
        <div class="card-header">
          <i class="pi pi-lock"></i>
          <h1>Recupera password</h1>
          <p>Inserisci la tua email per ricevere il link di reset</p>
        </div>
      </ng-template>

      <!-- Success state -->
      @if (submitted) {
        <div class="success-state">
          <i class="pi pi-check-circle"></i>
          <p class="success-message">
            Se l'email esiste, riceverai un link per il reset della password.
          </p>
          <p-button
            label="Torna al login"
            icon="pi pi-arrow-left"
            routerLink="/login"
            severity="primary"
            [outlined]="true"
          />
        </div>
      }

      <!-- Form state -->
      @if (!submitted) {
        <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()">
          <!-- Email field -->
          <div class="field">
            <label for="email">Email</label>
            <input
              id="email"
              type="email"
              pInputText
              formControlName="email"
              placeholder="La tua email registrata"
              [class.ng-invalid]="isFieldInvalid('email')"
              [class.ng-dirty]="isFieldInvalid('email')"
            />
            @if (isFieldInvalid('email')) {
              <small class="p-error">
                @if (forgotForm.get('email')?.hasError('required')) {
                  L'email Ã¨ obbligatoria.
                } @else if (forgotForm.get('email')?.hasError('email')) {
                  Inserisci un indirizzo email valido.
                }
              </small>
            }
          </div>

          <!-- Submit button -->
          <p-button
            type="submit"
            label="Invia link di reset"
            icon="pi pi-send"
            severity="primary"
            styleClass="w-full"
            [loading]="submitting"
            [disabled]="submitting"
          />
        </form>
      }

      <!-- Back to login link -->
      <ng-template pTemplate="footer">
        <div class="back-link">
          <a routerLink="/login">
            <i class="pi pi-arrow-left"></i>
            Torna al login
          </a>
        </div>
      </ng-template>
    </p-card>
  </div>
</main>

<!-- Page footer -->
<app-footer />
